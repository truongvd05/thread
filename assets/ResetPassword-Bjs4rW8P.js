import{a as y,e as S,r as i,c as v,j as s,I as l,B as C,N as P,g as q}from"./index-Dtuzz_vv.js";import{C as E,a as R,b as _,c as I}from"./card-DogHRojM.js";import{o as O,c as $,a as m,b as B}from"./yup-Dy2rZVMU.js";const F=$({password:m().required("Vui lòng nhập mật khẩu"),password_confirmation:m().oneOf([B("password")],"Mật khẩu không trùng khớp").required("Vui lòng nhậpt lại mật khẩu")});function H(){const d=y(),[u]=S(),[h,t]=i.useState(!1),[p,r]=i.useState(!1),x=u.get("token"),f=localStorage.getItem("email"),{register:o,handleSubmit:g,watch:L,setError:n,formState:{errors:e}}=v({resolver:O(F)}),j=async w=>{t(!0);const k={token:x,email:f,...w};try{(await q(k)).success&&(r(!0),setTimeout(()=>{d("/login")},5e3))}catch(a){const c=a?.errors||{};Object.keys(c).length?Object.entries(c).forEach(([N,b])=>{n(N,{type:"manual",message:b})}):n("email",{type:"manual",message:a?.message||"Đăng ký thất bại"})}finally{t(!1),r(!1)}};return s.jsxs(E,{className:"w-full max-w-sm m-auto",children:[s.jsx(R,{children:s.jsx(_,{className:"m-auto",children:"Reset Password"})}),s.jsxs("form",{className:"flex flex-col items-center gap-2",onSubmit:g(j),children:[s.jsxs("div",{className:"flex flex-col w-[80%] m-auto gap-2",children:[s.jsx(l,{type:"password",placeholder:"Mật khẩu mới",...o("password",{required:!0})}),e.password&&s.jsx("span",{className:"text-sm text-red-600",children:e?.password.message}),s.jsx(l,{type:"password",placeholder:"Xác nhận mật khẩu",...o("password_confirmation",{required:!0})}),e.password_confirmation&&s.jsx("span",{className:"text-sm text-red-600",children:e?.password_confirmation.message})]}),h&&s.jsx("i",{class:"fa-solid fa-spinner animate-spin text-gray-400"}),p&&s.jsx("span",{className:"text-sm text-green-500",children:"Đổi mật khẩu thành công"}),s.jsx(C,{className:"block",type:"submit",children:"Đồng ý"})]}),s.jsx(I,{className:" flex flex-col",children:s.jsx(P,{className:"",to:"/login",children:"Đã có tài khoản"})})]})}export{H as default};
