import{g as _,h as ee,b as te,r as h,v as re,j as t,I as L,B as ae,N as se,i as ne}from"./index-D-L5BnBK.js";import{C as ie,a as oe,b as ce,c as le}from"./card-BmmfJ32a.js";import{o as me,c as ue,a as q,b as de}from"./yup-D_lY0uCS.js";var G,J;function fe(){if(J)return G;J=1;var u="Expected a function",v=NaN,g="[object Symbol]",E=/^\s+|\s+$/g,$=/^[-+]0x[0-9a-f]+$/i,n=/^0b[01]+$/i,N=/^0o[0-7]+$/i,T=parseInt,F=typeof _=="object"&&_&&_.Object===Object&&_,w=typeof self=="object"&&self&&self.Object===Object&&self,M=F||w||Function("return this")(),S=Object.prototype,R=S.toString,C=Math.max,x=Math.min,c=function(){return M.Date.now()};function i(e,a,o){var f,b,I,p,s,m,j=0,P=!1,y=!1,A=!0;if(typeof e!="function")throw new TypeError(u);a=H(a)||0,d(o)&&(P=!!o.leading,y="maxWait"in o,I=y?C(H(o.maxWait)||0,a):I,A="trailing"in o?!!o.trailing:A);function z(r){var l=f,k=b;return f=b=void 0,j=r,p=e.apply(k,l),p}function K(r){return j=r,s=setTimeout(O,a),P?z(r):p}function Q(r){var l=r-m,k=r-j,V=a-l;return y?x(V,I-k):V}function U(r){var l=r-m,k=r-j;return m===void 0||l>=a||l<0||y&&k>=I}function O(){var r=c();if(U(r))return X(r);s=setTimeout(O,Q(r))}function X(r){return s=void 0,A&&f?z(r):(f=b=void 0,p)}function Y(){s!==void 0&&clearTimeout(s),j=0,f=m=b=s=void 0}function Z(){return s===void 0?p:X(c())}function D(){var r=c(),l=U(r);if(f=arguments,b=this,m=r,l){if(s===void 0)return K(m);if(y)return s=setTimeout(O,a),z(m)}return s===void 0&&(s=setTimeout(O,a)),p}return D.cancel=Y,D.flush=Z,D}function d(e){var a=typeof e;return!!e&&(a=="object"||a=="function")}function B(e){return!!e&&typeof e=="object"}function W(e){return typeof e=="symbol"||B(e)&&R.call(e)==g}function H(e){if(typeof e=="number")return e;if(W(e))return v;if(d(e)){var a=typeof e.valueOf=="function"?e.valueOf():e;e=d(a)?a+"":a}if(typeof e!="string")return e===0?e:+e;e=e.replace(E,"");var o=n.test(e);return o||N.test(e)?T(e.slice(2),o?2:8):$.test(e)?v:+e}return G=i,G}var pe=fe();const he=ee(pe),ge=ue({username:q().min(3,"tên ít nhất 3 kí tự").required("Tên người dùng là bắt buộc"),email:q().email("Email không hợp lệ").required("Email là bắt buộc"),password:q().min(8,"mật khẩu tối đa 8 kí tự").required("Mật khẩu là bắt buộc"),password_confirmation:q().oneOf([de("password")],"Mật khẩu không trùng khớp").required("Nhập lại mật khẩu")});function ye(){const{register:u,handleSubmit:v,setError:g,clearErrors:E,watch:$,formState:{errors:n}}=te({resolver:me(ge)}),[N,T]=h.useState(!1),[F,w]=h.useState(!1),[M,S]=h.useState(!1),R=async c=>{T(!0);try{const i=await ne(c);console.log(i),localStorage.setItem("access_token",i.access_token),localStorage.setItem("refresh_token",i.refresh_token),S(!0),E("email")}catch(i){const d=i?.errors||{};Object.keys(d).length?Object.entries(d).forEach(([B,W])=>{g(B,{type:"manual",message:W})}):g("email",{type:"manual",message:i?.message||"Đăng ký thất bại"})}finally{T(!1),setTimeout(()=>{S(!1)},5e3)}},C=$("email"),x=h.useCallback(he(async c=>{if(c){w(!0);try{const i=await re(c);E("email")}catch{g("email",{type:"manual",message:"email không hợp lệ"})}finally{w(!1)}}},500),[]);return h.useEffect(()=>{x(C)},[C]),h.useEffect(()=>()=>{x.cancel()},[x]),t.jsxs(t.Fragment,{children:[t.jsxs(ie,{className:"w-full max-w-sm m-auto",children:[t.jsx(oe,{children:t.jsx(ce,{className:"m-auto",children:"Register"})}),t.jsxs("form",{className:"flex flex-col items-center gap-2",onSubmit:v(R),children:[t.jsxs("div",{className:"flex flex-col w-[80%] m-auto gap-2",children:[t.jsx(L,{type:"text",autoComplete:"username",placeholder:"Tên người dùng",...u("username",{required:!0})}),n.username&&t.jsx("span",{className:"text-red-500 text-sm",children:n.username.message}),t.jsxs("div",{className:"relative",children:[t.jsx(L,{autoComplete:"email",type:"email",placeholder:"Email",...u("email",{required:!0})}),F&&t.jsx("i",{class:"fa-solid fa-spinner absolute right-3 top-1/2 -translate-y-1/2 animate-spin text-gray-400"})]}),n.email&&t.jsx("span",{className:"text-red-500 text-sm",children:n.email.message}),t.jsx(L,{type:"password",autoComplete:"new-password",placeholder:"Mật khẩu",...u("password",{required:!0})}),n.password&&t.jsx("span",{className:"text-red-500 text-sm",children:n.password.message}),t.jsx(L,{type:"password",autoComplete:"new-password",placeholder:"Xác nhận mật khẩu",...u("password_confirmation",{required:!0})}),n.password_confirmation&&t.jsx("span",{className:"text-red-500 text-sm",children:n.password_confirmation.message})]}),N&&t.jsx("i",{class:"fa-solid fa-spinner animate-spin text-gray-400"}),t.jsx(ae,{disabled:N,className:"block",type:"submit",children:"Đăng kí"})]}),t.jsx(le,{className:" flex flex-col",children:t.jsx(se,{className:"",to:"/login",children:"Đã có tài khoản"})})]}),t.jsx("div",{className:`${M?"opacity-100 scale-100 z-50 fixed":"opacity-0 scale-90 pointer-events-none z-[-1]"}
            top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 
            text-center bg-gray-200 rounded-2xl pointer-events-none"`,children:"Chúng tôi đã gửi một liên kết xác thực tới email của bạn. Vui lòng kiểm tra email để xác thực tài khoản"})]})}export{ye as default};
