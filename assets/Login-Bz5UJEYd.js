import{r,u as y,a as b,b as S,c as E,j as e,I as i,B as v,N as m,l as C,s as _,f as I}from"./index-DqlBNZ2l.js";import{C as L,a as V,b as q,c as F}from"./card-DgB0kVCu.js";import{o as B,c as U,a as d}from"./yup-rhJlH3le.js";const $=U({login:d().required("Vui lòng nhập Email"),password:d().required("Vui lòng nhập mật khẩu")});function R(){const[u,t]=r.useState(!1),[p,h]=r.useState(!1),o=y(),x=b(),{state:n}=S();r.useEffect(()=>{n?.verified&&h(!0)},[n]);const{register:c,handleSubmit:g,setError:l,watch:f,clearErrors:j,formState:{errors:s}}=E({resolver:B($)}),w=f("password");r.useEffect(()=>{l("err",null)},[w]);const N=async k=>{t(!0);try{const a=await C(k);localStorage.setItem("access_token",a.access_token),localStorage.setItem("refresh_token",a.refresh_token),o(_(a.user)),j("err"),x("/home"),o(I({type:"for_you",page:1,per_page:5}))}catch(a){console.log(a),l("err",{type:"manual",message:"Sai tài khoản hoặc mật khẩu"})}finally{t(!1)}};return e.jsxs(L,{className:"w-full max-w-sm m-auto",children:[e.jsxs(V,{children:[e.jsx(q,{className:"m-auto",children:"Log in with your Instagram account"}),p&&e.jsx("p",{className:"text-green-500 text-center",children:"Đã xác minh tài khoản thành công. Vui lòng đăng nhập."})]}),e.jsxs("form",{className:"flex flex-col items-center gap-2",onSubmit:g(N),children:[e.jsxs("div",{className:"flex flex-col w-[80%] m-auto gap-2",children:[e.jsx(i,{type:"email",autoComplete:"username",placeholder:"Email",...c("login",{required:!0})}),s.login&&e.jsx("span",{className:"text-red-500 text-sm",children:s.login.message}),e.jsx(i,{type:"password",autoComplete:"current-password",placeholder:"password",...c("password",{required:!0})}),s.password&&e.jsx("span",{className:"text-red-500 text-sm",children:s.password.message})]}),s.err&&e.jsx("span",{className:"text-red-500 text-sm",children:s.err.message}),e.jsx(v,{disabled:u,className:"block",type:"submit",children:"submit"})]}),e.jsxs(F,{className:" flex flex-col",children:[e.jsx(m,{className:"",to:"/forgot-password",children:"Forgot PassWord?"}),e.jsxs("p",{children:["Bạn chưa có tài khoản? ",e.jsx(m,{to:"/register",children:"Đăng ký"})]})]})]})}export{R as default};
